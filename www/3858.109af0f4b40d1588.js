"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3858],{3858:(I,d,s)=>{s.r(d),s.d(d,{AccountsPage:()=>U});var g=s(5861),i=s(8606),P=s(4716),u=s(8162),h=s(2726),p=s(6814),b=s(95),t=s(6689),f=s(5472),O=s(1725),C=s(9862),M=s(1517);function v(r,_){if(1&r&&t._UZ(0,"img",15),2&r){const e=t.oxw();t.Q6J("src","https://api.veluxpay.com/"+e.userImage,t.LSH)}}function D(r,_){if(1&r&&t._UZ(0,"img",15),2&r){const e=t.oxw();t.Q6J("src",e.image,t.LSH)}}function A(r,_){1&r&&t._UZ(0,"img",16)}function T(r,_){if(1&r&&t._UZ(0,"img",15),2&r){const e=t.oxw();t.Q6J("src",e.image,t.LSH)}}let U=(()=>{class r{constructor(e,o,n,a,l,c,m,E){this.alertController=e,this.router=o,this.plt=n,this.http=a,this.loadingCtrl=l,this.toastCtrl=c,this.authService=m,this.actionSheetCtrl=E,this.images=[]}ngOnInit(){var e=this;return(0,g.Z)(function*(){const o=localStorage.getItem("userData");if(o){e.userData=JSON.parse(o);const[n,a]=e.userData?.loginData.email.split("@"),m=`${n.substring(0,3)+"*".repeat(n.length-2)}@${a.substring(0,1)+"*".repeat(a.length-2)+a.substring(a.length-4)}`;console.log(m),e.emailx=m,console.log("I am"+e.emailx)}e.getImage(),e.userImageExists=!!e.userImage})()}getImage(){const e=localStorage.getItem("userImage");e&&(this.userImage=JSON.parse(e))}takePicture(){var e=this;return(0,g.Z)(function*(){try{"web"!=h.dV.getPlatform()&&(yield u.V1.requestPermissions());const o=yield u.V1.getPhoto({source:u.oK.Prompt,width:600,resultType:u.dk.DataUrl});console.log("image",o),e.image=o.dataUrl;const n=e.dataUrltoBlob(o.dataUrl),a="VeluxPay"+(new Date).getTime()+".jpeg",l=new File([n],a,{type:"image/png"});console.log(l);let c=new FormData;c.append("image",l),e.uploadData(c)}catch{}})()}takePicturex(){var e=this;return(0,g.Z)(function*(){try{const o=yield u.V1.getPhoto({quality:90,allowEditing:!1,resultType:u.dk.DataUrl,source:u.oK.Prompt});console.log("image",o),e.image=o.dataUrl;const n=e.dataUrltoBlob(o.dataUrl),a="VeluxPay"+(new Date).getTime()+".jpeg",l=new File([n],a,{type:"image/png"});console.log(l);let c=new FormData;c.append("image",l),e.uploadData(c)}catch{}})()}uploadData(e){var o=this;return(0,g.Z)(function*(){console.log(e),o.authService.profile(e).pipe((0,P.x)(()=>{})).subscribe(n=>{console.log(e+"in sub"),console.log(e+"Divine"),console.log(n),o.presentToast(n.success?"File upload complete.":"File upload failed.")})})()}presentToast(e){var o=this;return(0,g.Z)(function*(){(yield o.toastCtrl.create({message:e,duration:3e3})).present()})()}dataUrltoBlob(e){let o=e.split(","),n=o[0].match(/:(.*?);/)[1],a=atob(o[1]),l=a.length,c=new Uint8Array(l);for(;l--;)c[l]=a.charCodeAt(l);return new Blob([c],{type:n})}presentAlertx(e,o){var n=this;return(0,g.Z)(function*(){yield(yield n.alertController.create({header:"Velux Pay",subHeader:e||"Sub Account",message:o||"Coming Soon...",buttons:[{text:"Ok",cssClass:"alert-button-confirm"}],backdropDismiss:!1,cssClass:"custom-alert",animated:!0,mode:"ios",translucent:!0})).present()})()}verifications(){this.router.navigateByUrl("/accounts/verification")}subAccount(){this.router.navigateByUrl("/subaccount")}deleteAccount(){this.delete()}remove(){this.authService.remove().subscribe(e=>{console.log("Account Deleted successfully!",e),"registration failed"===e.message||"Signature verification failed"===e.message&&"/auth-screen"!==this.router.url&&(localStorage.removeItem("userData"),localStorage.removeItem("res"),localStorage.removeItem("accessT"),this.router.navigateByUrl("/auth-screen"))},e=>{console.error("Unable to complete failed request!",e)})}delete(){var e=this;return(0,g.Z)(function*(){const o=yield e.actionSheetCtrl.create({header:"Are you sure you want to Delete Your Account?",buttons:[{text:"Yes",handler:()=>{e.remove()}},{text:"No",role:"cancel"}]});yield o.present();const{role:n}=yield o.onWillDismiss();return"confirm"===n})()}tag(){this.presentAlertx("Tag Name","Cannot be changed!")}name(){this.presentAlertx("Full Name","User Name cannot be changed!")}email(){this.presentAlertx("Email Address","User email cannot be changed!")}static#t=this.\u0275fac=function(o){return new(o||r)(t.Y36(i.Br),t.Y36(O.F0),t.Y36(f.t4),t.Y36(C.eN),t.Y36(i.HT),t.Y36(i.yF),t.Y36(M.e),t.Y36(i.BX))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-accounts"]],standalone:!0,features:[t.jDz],decls:38,vars:8,consts:[[1,"toolbar-padding"],["slot","start"],["defaultHref","tabs/profiles"],["mode","ios"],["align","center",3,"click"],[3,"click"],["alt","",3,"src",4,"ngIf"],["src","assets/images/avatar.png","alt","Dummy Image",4,"ngIf"],[3,"inset"],["lines","none","detail","false",3,"click"],["name","pricetag-outline","slot","start"],["lines","none",3,"click"],["name","person-outline","slot","start"],["name","mail-unread","slot","start"],["color","danger",1,"ion-text-center"],["alt","",3,"src"],["src","assets/images/avatar.png","alt","Dummy Image"]],template:function(o,n){1&o&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title",3),t._uU(5,"Accounts"),t.qZA()()(),t.TgZ(6,"ion-content")(7,"div",4),t.NdJ("click",function(){return n.takePicturex()}),t.TgZ(8,"ion-avatar",5),t.NdJ("click",function(){return n.takePicturex()}),t.YNc(9,v,1,1,"img",6),t.YNc(10,D,1,1,"img",6),t.YNc(11,A,1,0,"img",7),t.YNc(12,T,1,1,"img",6),t.qZA()(),t.TgZ(13,"ion-list",8)(14,"ion-item",9),t.NdJ("click",function(){return n.tag()}),t._UZ(15,"ion-icon",10),t.TgZ(16,"ion-label")(17,"h2"),t._uU(18," Tag Name: "),t.qZA(),t.TgZ(19,"ion-text"),t._uU(20),t.qZA()()(),t.TgZ(21,"ion-item",11),t.NdJ("click",function(){return n.name()}),t._UZ(22,"ion-icon",12),t.TgZ(23,"ion-label")(24,"h2"),t._uU(25," Full Name "),t.qZA(),t._uU(26),t.qZA()(),t.TgZ(27,"ion-item",9),t.NdJ("click",function(){return n.email()}),t._UZ(28,"ion-icon",13),t.TgZ(29,"ion-label")(30,"h2"),t._uU(31," Email Address "),t.qZA(),t.TgZ(32,"ion-text"),t._uU(33),t.qZA()()(),t.TgZ(34,"ion-item",11),t.NdJ("click",function(){return n.deleteAccount()}),t.TgZ(35,"ion-label",14)(36,"ion-text"),t._uU(37,"Delete account"),t.qZA()()()()()),2&o&&(t.xp6(9),t.Q6J("ngIf",n.userImage&&!n.image),t.xp6(1),t.Q6J("ngIf",!n.userImage&&n.image),t.xp6(1),t.Q6J("ngIf",!n.userImage&&!n.image),t.xp6(1),t.Q6J("ngIf",n.userImage&&n.image),t.xp6(1),t.Q6J("inset",!0),t.xp6(7),t.hij(" ",null==n.userData?null:n.userData.loginData.user_tag,""),t.xp6(6),t.hij(" ",null==n.userData?null:n.userData.loginData.full_name," "),t.xp6(7),t.Oqu(n.emailx))},dependencies:[p.ez,p.O5,b.u5,i.Pc,i.BJ,i.Sm,i.W2,i.Gu,i.gu,i.Ie,i.Q$,i.q_,i.yW,i.wd,i.sr,i.oU],styles:[".toolbar-padding[_ngcontent-%COMP%]{padding-top:2rem}ion-content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-top:2rem}ion-content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{border-radius:50%;border:1px solid var(--ion-color-medium);height:4.5rem;width:4.5rem}ion-content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:transparent;font-weight:700;font-size:1.1rem;margin-bottom:1rem;margin-top:.5rem}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:transparent}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-style: box;--border-color: var(--ion-color-base);--border-radius:3%;--padding-bottom: 1rem;--padding-start: 0;--padding-end: 0}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%]{margin-right:-.6rem}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:var(--ion-color-medium)}ion-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#7e219e;border-radius:25px}ion-content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-bottom:10vh}ion-content[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%]{--background-checked: #7E219E}ion-alert.custom-alert[_ngcontent-%COMP%]{--backdrop-opacity: .7}.custom-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]{padding:8px}button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{background-color:var(--ion-color-success);color:var(--ion-color-success-contrast)}.md[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-radius:4px}.ios[_ngcontent-%COMP%]   .custom-alert[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{border:.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0),.2)}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-cancel[_ngcontent-%COMP%]{border-right:0;border-bottom-left-radius:13px;border-top-left-radius:13px}.ios[_ngcontent-%COMP%]   button.alert-button.alert-button-confirm[_ngcontent-%COMP%]{border-bottom-right-radius:13px;border-top-right-radius:13px}"]})}return r})()}}]);