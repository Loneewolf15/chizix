"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6812],{6812:(U,h,g)=>{g.r(h),g.d(h,{AirtimePage:()=>y});var d=g(5861),i=g(8606),s=g(95),f=g(6662),p=g(6814),e=g(6689),C=g(1725),A=g(9140),P=g(1517),T=g(7911);function M(m,_){1&m&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Airtime"),e.qZA()()())}function b(m,_){if(1&m){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",3),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showContent=!0)}),e._UZ(4,"ion-icon",4),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Airtime"),e.qZA()()()}}function v(m,_){if(1&m){const t=e.EpF();e.TgZ(0,"ion-content"),e._UZ(1,"br"),e.TgZ(2,"ion-item",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.logCardValue("mtn"),e.KtG(o.showContent=!1)}),e._UZ(3,"ion-img",6),e.TgZ(4,"ion-label",7),e._uU(5," MTN "),e.qZA(),e._UZ(6,"ion-icon",8),e.qZA(),e.TgZ(7,"ion-item",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.logCardValue("airtel"),e.KtG(o.showContent=!1)}),e._UZ(8,"ion-img",10),e.TgZ(9,"ion-label",11),e._uU(10," Airtel"),e.qZA(),e._UZ(11,"ion-icon",8),e.qZA(),e.TgZ(12,"ion-item",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.logCardValue("glo"),e.KtG(o.showContent=!1)}),e._UZ(13,"ion-img",13),e.TgZ(14,"ion-label",11),e._uU(15," GLO "),e.qZA(),e._UZ(16,"ion-icon",8),e.qZA(),e.TgZ(17,"ion-item",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.logCardValue("etisalat"),e.KtG(o.showContent=!1)}),e._UZ(18,"ion-img",15),e.TgZ(19,"ion-label",11),e._uU(20," 9mobile "),e.qZA(),e._UZ(21,"ion-icon",8),e.qZA()()}}function x(m,_){if(1&m){const t=e.EpF();e.TgZ(0,"ion-content")(1,"div")(2,"ion-list")(3,"form")(4,"div",16)(5,"ion-input",17),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.phone=o)}),e.qZA()(),e.TgZ(6,"div",16)(7,"ion-input",18),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.amountx=o)}),e.qZA()(),e.TgZ(8,"div",16)(9,"ion-input",19),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.pin=o)}),e.qZA()(),e.TgZ(10,"div"),e._UZ(11,"br"),e.TgZ(12,"ion-button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.topUp())}),e._UZ(13,"ion-icon",21),e._uU(14,"Top Up"),e.qZA()()()()()()}if(2&m){const t=e.oxw();e.xp6(5),e.Q6J("counter",!0)("counterFormatter",t.customCounterFormatterE)("ngModel",t.phone),e.xp6(2),e.Q6J("counter",!0)("counterFormatter",t.customCounterFormatterE)("ngModel",t.amountx),e.xp6(2),e.Q6J("counter",!0)("counterFormatter",t.customCounterFormatterE)("ngModel",t.pin)}}let y=(()=>{class m{constructor(t,n,o,a,c,r,u,l,Z,O,D,I,E){this.loadingCtrl=t,this.loadingController=n,this.formBuilder=o,this.router=a,this.modalCtrl=c,this.loadingCtl=r,this.modalController=u,this.toastCtrl=l,this.toastController=Z,this.storage=O,this.authService=D,this.toastService=I,this.alertController=E,this.formData={phone:"",amount:"",pin:""},this.formDatax={phone:"",amount:""},this.showContent=!0,this.cardValue="",this.serviceIDx="",this.showContent1=!0,this.showContent2=!1,this.isLoading=!1,this.type=!0,this.verified=!1}initForm(){this.form=new s.cw({phone:new s.NI(null,{validators:[s.kI.required]}),pin:new s.NI(null,{validators:[s.kI.required,s.kI.minLength(4),s.kI.maxLength(4)]}),amountx:new s.NI(null,{validators:[s.kI.required,s.kI.minLength(3)]})})}validateData(){return this.formDatax.phone&&this.formDatax.amount&&this.formData.pin&&this.formDatax.phone.length>0&&this.formDatax.amount.length>0&&this.formData.pin.length>0}ngOnInit(){this.phoneNumber="",this.formDatax.amount="",this.pin=""}logCardValue(t){this.cardValue=t,console.log(t)}presentToast(t,n){var o=this;return(0,d.Z)(function*(){(yield o.toastController.create({message:t,duration:2e3,position:"bottom",color:n})).present()})()}showLoader(t){return this.isLoading||(this.isLoading=!0),this.loadingCtrl.create({message:t,spinner:"bubbles"}).then(n=>{n.present().then(()=>{this.isLoading||n.dismiss().then(()=>{console.log("abort presenting")})})}).catch(n=>{this.isLoading=!1,console.log(n)})}presentLoading(t,n){var o=this;return(0,d.Z)(function*(){yield(yield o.loadingCtl.create({message:t,spinner:n})).present()})()}hideLoader(){return this.isLoading&&(this.isLoading=!1),this.loadingCtrl.dismiss().then(()=>console.log("dismissed")).catch(t=>console.log(t))}presentAirtimeAlert(t,n,o,a){var c=this;return(0,d.Z)(function*(){let r,u;switch(t){case"transaction successful":r=`You have successfully purchased airtime of \u20a6${n} `,u="assets/imgs/success.png";break;case"insuficient funds":r=`Transaction amount greater than wallet balance. <br> \u20a6${n}.00`,u="assets/imgs/failed.png";break;case"airtime purchase failed":r="We could not complete your request at this moment, please try again shortly.",u="assets/imgs/less.png";break;case"Duplicate transaction detected":r="We noticed that this transaction is a duplicate transaction, please try again shortly.",u="assets/imgs/less.png";break;default:r="An unknown error occurred!!<br>Please try again later",u="assets/imgs/less.png"}c.header=o||"Airtime Status",c.status=t||"Unknown",c.amount=n||"50",c.message=r,yield(yield c.modalController.create({component:f.d,componentProps:{header:c.header,status:c.status,amount:c.amount,message:c.message,imgSrc:u,subHeader:a},cssClass:"transaction-modal"})).present()})()}customCounterFormatter(t,n){return n-t+" characters remaining"}customCounterFormatterE(t,n){return n-t+" characters remaining"}topUp(){var t=this;console.log(this.serviceIDx=this.cardValue+" i am here");const n={network_id:this.cardValue,phone:this.phone,amount:this.amountx};if(console.log(this.serviceIDx=this.cardValue+" i am herey"+JSON.stringify({userPin:this.pin})+JSON.stringify(n)),this.presentLoading("Validating...","crescent"),4===this.pin.length){console.log(this.pin);const a={transferPin:this.pin};console.log("I am "+a),this.authService.checkPin(a).subscribe(function(){var c=(0,d.Z)(function*(r){console.log(r),console.log(r.message),"Signature verification failed"===r.message&&"/auth-screen"!==t.router.url&&"Session has expired."===r.message&&"/vtu/airtime"===t.router.url?(t.toastController.create(),t.presentToast("Session Expired.....Logging out","danger"),t.router.navigateByUrl("/auth-screen")):"correct pin"===r?(yield t.toastCtrl.create({message:"Pin is Valid.",duration:3e3,position:"bottom"}),t.loadingCtl.dismiss(),t.hideLoader(),t.modalCtrl.dismiss(r),t.presentLoading("Processing your request...","circular"),console.log(n),t.authService.airtime(n).subscribe(l=>{console.log(JSON.stringify(l)),"Signature verification failed"===l.message&&"/auth-screen"!==t.router.url&&"/vtu/airtime"===t.router.url?(localStorage.removeItem("userData"),localStorage.removeItem("res"),localStorage.removeItem("accessT"),t.toastController.create(),t.presentToast("Session Expired.....Logging out","danger"),t.router.navigateByUrl("/auth-screen")):"insuficient funds"===l.message?(t.toastController.create(),t.presentToast(l.message+", Please fund your account and try again","danger"),t.presentAirtimeAlert(l.message,` \u20a6${n.amount}`,"Transaction Failed"),t.loadingCtl.dismiss()):"INSUFFICIENT_BALANCE"===l.message?(t.toastController.create(),t.presentToast(l.message+", An unknown error occured please try again shortly.","danger"),t.presentAirtimeAlert("transaction failed",` \u20a6${n.amount}`,"Incomplete Request"),t.loadingCtl.dismiss()):"transaction succesful"===l.message?(t.toastController.create(),t.presentToast(l.message+",Airtime topped up","success"),t.presentAirtimeAlert("transaction successful",` \u20a6${n.amount}`,"Transaction Successful"),t.loadingCtl.dismiss()):"AMOUNT_BELOW_MIN"===l.message?(t.toastController.create(),t.presentToast("Amount entered below minimum value.","danger"),t.presentAirtimeAlert("transaction failed",` \u20a6${n.amount}`,"Incomplete Request"),t.loadingCtl.dismiss()):"airtime purchase failed"===l.message?(t.toastController.create(),t.presentToast("An unknown error occured please try again shortly.","danger"),t.presentAirtimeAlert("transaction failed",` \u20a6${n.amount}`,"Incomplete Request"),t.loadingCtl.dismiss()):(t.toastController.create(),t.presentToast(l.message,"success"),t.loadingCtl.dismiss())},l=>{console.error(l),console.log("Error found here"),t.loadingCtl.dismiss()}),t.loadingCtl.dismiss(a)):((yield t.toastCtrl.create({message:"Invalid User Pin. Please try again.",duration:2e3,position:"bottom",color:"danger"})).present(),console.log("Hello Dickson"),t.loadingCtrl.dismiss(),t.hideLoader(),t.modalCtrl.dismiss(a),console.log("I am here"),t.loadingCtrl.dismiss())});return function(r){return c.apply(this,arguments)}}(),function(){var c=(0,d.Z)(function*(r){console.log(r),(yield t.toastCtrl.create({message:"Invalid User Pin. Please try again.",duration:2e3,position:"bottom",color:"danger"})).present(),console.log("Hello Dickson"),t.loadingCtrl.dismiss(),t.hideLoader(),t.modalCtrl.dismiss(a),console.log("I am here"),t.loadingCtrl.dismiss()});return function(r){return c.apply(this,arguments)}}()),this.loadingCtrl.dismiss()}return this.loadingCtrl.dismiss(),!(this.validateData()&&!this.form.valid)||(this.form.markAllAsTouched(),this.formData.phone&&this.formData.amount&&this.formData.phone.length>0&&this.formData.amount.length>0)}static#e=this.\u0275fac=function(n){return new(n||m)(e.Y36(i.HT),e.Y36(i.HT),e.Y36(s.qu),e.Y36(C.F0),e.Y36(i.IN),e.Y36(i.HT),e.Y36(i.IN),e.Y36(i.yF),e.Y36(i.yF),e.Y36(A.yW),e.Y36(P.e),e.Y36(T.k),e.Y36(i.Br))};static#t=this.\u0275cmp=e.Xpm({type:m,selectors:[["app-airtime"]],standalone:!0,features:[e.jDz],decls:5,vars:4,consts:[[4,"ngIf"],["slot","start"],["defaultHref","/tabs/wallets"],[3,"click"],["slot","icon-only","name","arrow-back"],["color","tertiary","lines","none","value","MTN",1,"bundle-items",3,"click"],["src","assets/images/mtn-logo-img.png","alt","Mtn"],["font-size","16px;",1,"ion-llabel"],["name","chevron-forward-outline","slot","end"],["color","tertiary","lines","none","value","Airtel",1,"bundle-items",3,"click"],["src","assets/images/airtel-logo-img.png","alt","Mtn"],[1,"ion-llabel"],["color","tertiary","lines","none","value","GLO",1,"bundle-items",3,"click"],["src","assets/images/glo-logo-img.png","alt","Mtn"],["color","tertiary","lines","none","value","9mobile",1,"bundle-items",3,"click"],["src","assets/images/9mobile-logo-img.png","alt","Mtn"],[1,"ion-margin-vertical"],["label","Phone Number","label-placement","floating","autocomplete","","minlength","11","maxlength","11","errorText","* Please enter phone number","name","phone","type","tel",3,"counter","counterFormatter","ngModel","ngModelChange"],["label","Airtime Amount","label-placement","floating","autocomplete","","minlength","3","errorText","* Please enter valid amount","name","amountx","type","number",3,"counter","counterFormatter","ngModel","ngModelChange"],["label","Transaction Pin","label-placement","floating","autocomplete","","minlength","4","maxlength","4","errorText","* Please enter your pin","name","pin","type","password",3,"counter","counterFormatter","ngModel","ngModelChange"],["expand","block","width","50%","color","warning",1,"top-upx",3,"click"],["name","reload-circle-outline"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-content"),e.YNc(1,M,6,0,"ion-header",0),e.YNc(2,b,7,0,"ion-header",0),e.YNc(3,v,22,0,"ion-content",0),e.YNc(4,x,15,9,"ion-content",0),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",o.showContent),e.xp6(1),e.Q6J("ngIf",!o.showContent),e.xp6(1),e.Q6J("ngIf",o.showContent),e.xp6(1),e.Q6J("ngIf",!o.showContent))},dependencies:[p.ez,p.O5,s.u5,s._Y,s.JJ,s.JL,s.wO,s.nD,s.On,s.F,i.Pc,i.YG,i.Sm,i.W2,i.Gu,i.gu,i.Xz,i.pK,i.Ie,i.Q$,i.q_,i.wd,i.sr,i.as,i.j9,i.oU],styles:["ion-toolbar[_ngcontent-%COMP%]{padding-top:1rem!important;padding-inline:1rem}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700}body[_ngcontent-%COMP%]{font-family:Arial,sans-serif}ion-input[_ngcontent-%COMP%]{border-radius:5px}ion-input[_ngcontent-%COMP%]:focus{outline:none}ion-card-header.ios[_ngcontent-%COMP%]{display:flex;flex-flow:column-reverse}ion-card-title[_ngcontent-%COMP%]{--color: #cbff52;align-items:center;justify-content:center;margin:auto;padding:auto}ion-card-content[_ngcontent-%COMP%]{align-items:center;justify-content:center;margin:auto;padding:auto}ion-card-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}ion-select[_ngcontent-%COMP%]{border:none;outline:none;appearance:none}.bundle-items[_ngcontent-%COMP%]{background-color:#1f1f1f;border-radius:.5rem;padding:1rem;font-weight:700;margin-bottom:.5rem;margin-inline:.8rem}.bundle-items[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.8rem}.bundle-items[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{margin-right:.8rem}"]})}return m})()}}]);