"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1063],{1063:(D,c,a)=>{a.r(c),a.d(c,{SubaccountPage:()=>U});var g=a(5861),u=a(6814),_=a(95),o=a(8606),t=a(6689),m=a(1725),d=a(9140),b=a(1517),f=a(7911);function v(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label")(2,"ion-text"),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"ion-note"),t._uU(6,"Username: "),t.TgZ(7,"b"),t._uU(8),t.qZA()(),t._UZ(9,"br"),t.TgZ(10,"ion-note"),t._uU(11),t.qZA()(),t.TgZ(12,"ion-icon",7),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.deleteSubUser(i.user_tag,i.veluxite_id))}),t.qZA()()}if(2&n){const e=h.$implicit;t.xp6(3),t.Oqu(null==e?null:e.title),t.xp6(5),t.Oqu(null==e?null:e.user_tag),t.xp6(3),t.hij("Password: ",null==e?null:e.password," ")}}function S(n,h){if(1&n&&(t.TgZ(0,"ion-list",5)(1,"ion-item-group"),t.YNc(2,v,13,3,"ion-item",6),t.qZA()()),2&n){const e=t.oxw();t.Q6J("inset",!0),t.xp6(2),t.Q6J("ngForOf",e.subUser)}}let U=(()=>{class n{constructor(e,s,r,i,l,p,y,C,T,P,A,O,E){this.alertController=e,this.router=s,this.loadingCtl=r,this.toastCtl=i,this.loadingCtrl=l,this.formBuilder=p,this.modalCtrl=y,this.toastCtrl=C,this.storage=T,this.authService=P,this.toastService=A,this.toastController=O,this.modalController=E,this.subAccounts=[],this.subUser=[],setInterval(()=>{console.log("fetching users.....huurraay"),this.getSubUser()},45e3)}ngOnInit(){this.getSubUser(),this.subAccounts=[{id:1,title:"Account 1",username:"Globalstore001",password:"revalueter"},{id:2,title:"Account 2",username:"Globalstore002",password:"revalueter"},{id:3,title:"Account 3",username:"Globalstore003",password:"revalueter"},{id:4,title:"Account 4",username:"Globalstore004",password:"revalueter"},{id:5,title:"Account 5",username:"Globalstore005",password:"revalueter"}]}registerSub(){this.router.navigateByUrl("/register2")}showToastx(e){var s=this;return(0,g.Z)(function*(){(yield s.toastCtrl.create({message:e,duration:2e3,color:"success"})).present()})()}presentAlertr(e,s){var r=this;return(0,g.Z)(function*(){yield(yield r.alertController.create({header:"Velux Pay",subHeader:e,message:s,buttons:[{text:"OK",cssClass:"alert-button-confirm",handler:()=>{"Failed"!==e&&r.router.navigateByUrl("/tabs")}}],backdropDismiss:!1,cssClass:"custom-alert",animated:!0,mode:"ios",translucent:!0})).present()})()}enroll(){this.authService.createSub().subscribe(e=>{console.log("Sub Account Creation successful!",e),"registration failed"===e.message?(this.toastService.showToast(e.message+", Please try again shortly"),this.router.navigateByUrl("/register2")):"Signature verification failed"===e.message&&"/auth-screen"!==this.router.url?(localStorage.removeItem("userData"),localStorage.removeItem("res"),localStorage.removeItem("accessT"),this.toastService.showToast("Session Expired.....Logging out"),this.router.navigateByUrl("/auth-screen")):(this.showToastx(e.message),this.presentAlertr("Success",`Sub Account successfully created and your user_tagname is ${e.tagname}!`),this.router.navigateByUrl("/subaccount"))},e=>{console.error("Unable to complete failed request!",e),this.presentAlertr("Failed","Sub Account creation failed, Please try again!"),this.router.navigateByUrl("/subaccount"),this.toastService.showToast("Check your internet connection || Network connection failed")})}getSubUser(){this.authService.getSubUser().subscribe(e=>{if("Signature verification failed"===e.message&&"/auth-screen"!==this.router.url&&"/subaccount"===this.router.url)localStorage.removeItem("userData"),localStorage.removeItem("res"),localStorage.removeItem("accessT"),this.toastController.create(),this.router.navigateByUrl("/auth-screen");else{console.log(e),this.subUser=e;for(let s of e)console.log(s.full_name);console.log("Returned Data",e),console.log("Fullnames",e.full_name)}},e=>{"/subaccount"===this.router.url&&(this.toastService.showToast("Could not complete your request try again!"),console.error("Could not complete your request try again!",e))})}deleteSubUser(e,s){const r=new FormData;r.append("veluxite_id",s),r.append("user_tag",e),console.log(r);const i={veluxite_id:s,user_tag:e};console.log(i),this.authService.deleteSub(i).subscribe(l=>{"Signature verification failed"===l.message&&"/auth-screen"!==this.router.url&&"/subaccount"===this.router.url?(localStorage.removeItem("userData"),localStorage.removeItem("res"),localStorage.removeItem("accessT"),this.toastController.create(),this.router.navigateByUrl("/auth-screen")):(console.log(l),"deleted sucessfully"===l.message&&(this.showToastx("Sub Account successfully deleted"),this.router.navigateByUrl("/subaccount"),this.getSubUser()))},l=>{"/subaccount"===this.router.url&&(this.toastService.showToast("Could not complete your request try again!"),console.error("Could not complete your request try again!",l))})}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(o.Br),t.Y36(m.F0),t.Y36(o.HT),t.Y36(o.yF),t.Y36(o.HT),t.Y36(_.qu),t.Y36(o.IN),t.Y36(o.yF),t.Y36(d.yW),t.Y36(b.e),t.Y36(f.k),t.Y36(o.yF),t.Y36(o.IN))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-subaccount"]],standalone:!0,features:[t.jDz],decls:10,vars:1,consts:[["slot","start"],["defaultHref","/profiles/accounts"],["mode","ios"],["class","transactions",3,"inset",4,"ngIf"],["shape","block","color","medium",3,"click"],[1,"transactions",3,"inset"],[4,"ngFor","ngForOf"],["slot","end","name","trash",3,"click"]],template:function(s,r){1&s&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title",2),t._uU(5,"Sub Account"),t.qZA()()(),t.TgZ(6,"ion-content"),t.YNc(7,S,3,2,"ion-list",3),t.TgZ(8,"ion-button",4),t.NdJ("click",function(){return r.enroll()}),t._uU(9," Create new sub Account "),t.qZA()()),2&s&&(t.xp6(7),t.Q6J("ngIf",(null==r.subUser?null:r.subUser.length)>=1))},dependencies:[u.ez,u.sg,u.O5,_.u5,o.Pc,o.YG,o.Sm,o.W2,o.Gu,o.gu,o.Ie,o.Ub,o.Q$,o.q_,o.uN,o.yW,o.wd,o.sr,o.oU],styles:["ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:large;font-weight:700;color:var(--ion-color-base)}ion-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{padding-left:5px;margin-right:3px;color:var(--ion-color-base);font-size:medium;font-weight:200}ion-button[_ngcontent-%COMP%]{margin-top:30vh;margin-right:15%;margin-left:15%;--border-radius: 6px}"]})}return n})()}}]);